<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>CompoLink Platform</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- ============ AUTH SCHERM ============ -->
  <div id="auth-wrapper" class="auth-wrapper">
    <div class="auth-card">
      <h1>CompoLink</h1>
      <p class="auth-subtitle">
        Connect EU composite buyers & suppliers in één platform.
      </p>

      <div class="auth-tabs">
        <button id="login-tab" class="auth-tab active">Log in</button>
        <button id="signup-tab" class="auth-tab">Sign up</button>
      </div>

      <!-- LOGIN -->
      <form id="login-form" class="auth-form">
        <label>
          E-mail
          <input type="email" id="login-email" autocomplete="email" required />
        </label>
        <label>
          Wachtwoord
          <input
            type="password"
            id="login-password"
            autocomplete="current-password"
            required
          />
        </label>
        <p id="login-error" class="auth-error"></p>
        <button type="submit" class="primary-btn">Log in</button>
      </form>

      <!-- SIGNUP -->
      <form id="signup-form" class="auth-form hidden">
        <label>
          Naam
          <input type="text" id="signup-name" autocomplete="name" required />
        </label>
        <label>
          E-mail
          <input type="email" id="signup-email" autocomplete="email" required />
        </label>
        <label>
          Wachtwoord
          <input
            type="password"
            id="signup-password"
            autocomplete="new-password"
            required
          />
        </label>

        <fieldset class="role-fieldset">
          <legend>Accounttype</legend>
          <label>
            <input type="radio" name="signup-role" value="buyer" checked />
            Buyer (OEM / MRO / integrator)
          </label>
          <label>
            <input type="radio" name="signup-role" value="seller" />
            Seller (materials / semi-finished)
          </label>
        </fieldset>

        <p id="signup-error" class="auth-error"></p>
        <button type="submit" class="primary-btn">Account aanmaken</button>
      </form>
    </div>
  </div>

  <!-- ============ APP (NA INLOGGEN) ============ -->
  <div id="app" class="app hidden">
    <!-- TOP NAV (zoals oude layout) -->
    <header class="top-nav">
      <div class="nav-left">
        <span class="nav-logo">CompoLink</span>
      </div>
      <nav class="nav-center">
        <button class="nav-btn active" data-page="overview">Overview</button>
        <button class="nav-btn" data-page="stock">Stock</button>
        <button class="nav-btn" data-page="buyers">Buyers & Suppliers</button>
        <button class="nav-btn" data-page="analytics">Analytics</button>
        <button class="nav-btn" data-page="tracking">Tracking</button>
        <button class="nav-btn" data-page="community">Community feed</button>
        <button class="nav-btn" data-page="checkout">Checkout</button>
      </nav>
      <div class="nav-right">
        <span class="user-tag" id="user-tag">–</span>
        <button id="logout-btn" class="logout-btn">Log out</button>
      </div>
    </header>

    <main class="main-wrapper">
      <!-- ===== OVERVIEW (hero card zoals oude screenshot) ===== -->
      <section id="overview" class="page active-page">
        <div class="hero-shell">
          <div class="hero-card">
            <p class="hero-kicker">
              YOUR DIGITAL MARKETPLACE FOR COMPOSITE MATERIALS
            </p>
            <h1 class="hero-title">
              Connect buyers and suppliers of<br />composite materials.
            </h1>
            <p class="hero-text">
              CompoLink brings together European composite suppliers on a single
              platform. Buyers can instantly see which materials are in stock,
              including price, quality, lead time, and certifications – with
              complete transparency.
            </p>

            <div class="hero-actions">
              <button class="hero-btn primary-btn" data-page="stock">
                View stock
              </button>
              <button class="hero-btn ghost-btn" data-page="community">
                Community feed
              </button>
            </div>

            <div class="hero-tags">
              <span class="hero-tag">RFID track &amp; trace</span>
              <span class="hero-tag">Min / max orders</span>
              <span class="hero-tag">Real-time stock insight</span>
              <span class="hero-tag">5% platform fee</span>
            </div>
          </div>
        </div>
      </section>

      <!-- ===== STOCK PAGE ===== -->
      <section id="stock" class="page">
        <h2>Stock overview</h2>
        <p class="page-intro">
          Live material prices links, gecombineerd met actuele stockdata in het
          CompoLink netwerk.
        </p>

        <div class="stock-layout">
          <!-- Live koersen links -->
          <aside class="prices-panel">
            <h3>Live material prices</h3>
            <ul id="market-prices" class="market-prices-list"></ul>
            <p class="market-note">
              Indicatieve spotprijzen (goud, zilver, etc.) in USD. Automatisch
              ververst.
            </p>
          </aside>

          <!-- Stock tabel + mini-cart -->
          <div class="stock-panel">
            <div class="stock-table-card">
              <h3>Material list</h3>
              <table class="stock-table">
                <thead>
                  <tr>
                    <th>Materiaal</th>
                    <th>Prijs €/kg</th>
                    <th>Beschikbaar (kg)</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  <tr
                    data-item='{"id":"mat-carbon","name":"Carbon prepreg T700","price":38,"weight":50}'
                  >
                    <td>Carbon prepreg T700</td>
                    <td>€38,00</td>
                    <td>1500</td>
                    <td>
                      <button type="button" class="add-to-cart">
                        In mandje
                      </button>
                    </td>
                  </tr>
                  <tr
                    data-item='{"id":"mat-epoxy","name":"Epoxy resin system 2K","price":9.5,"weight":25}'
                  >
                    <td>Epoxy resin system 2K</td>
                    <td>€9,50</td>
                    <td>3200</td>
                    <td>
                      <button type="button" class="add-to-cart">
                        In mandje
                      </button>
                    </td>
                  </tr>
                  <tr
                    data-item='{"id":"mat-glass","name":"Glass fabric 450 g/m²","price":4.2,"weight":30}'
                  >
                    <td>Glass fabric 450 g/m²</td>
                    <td>€4,20</td>
                    <td>7800</td>
                    <td>
                      <button type="button" class="add-to-cart">
                        In mandje
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <aside class="cart-card">
              <h3>Mini-cart</h3>
              <ul id="cart-items" class="cart-items"></ul>
              <p id="cart-empty-msg" class="muted">
                Je mandje is nog leeg.
              </p>
              <p>Totaal gewicht: <span id="cart-weight">0.0</span> kg</p>
              <p>Materiaalprijs: €<span id="cart-total">0.00</span></p>
            </aside>
          </div>
        </div>
      </section>

      <!-- ===== BUYERS & SUPPLIERS (placeholder) ===== -->
      <section id="buyers" class="page">
        <h2>Buyers &amp; Suppliers</h2>
        <p class="page-intro">
          Hier kun je later supplier-profielen, certificaten en matching
          logica tonen. Voor nu is dit een placeholder.
        </p>
      </section>

      <!-- ===== ANALYTICS ===== -->
      <section id="analytics" class="page">
        <h2>Analytics</h2>
        <p class="page-intro">
          Demo-visualisatie van volumes per materiaaltype.
        </p>
        <div class="card">
          <div class="chart-wrapper">
            <canvas id="stockChart"></canvas>
          </div>
        </div>
      </section>

      <!-- ===== TRACKING (placeholder) ===== -->
      <section id="tracking" class="page">
        <h2>Tracking</h2>
        <p class="page-intro">
          Trackingpagina voor toekomstige RFID / shipment tracking. Nu nog
          placeholder.
        </p>
      </section>

      <!-- ===== COMMUNITY FEED ===== -->
      <section id="community" class="page">
        <h2>Community feed</h2>
        <p class="page-intro">
          LinkedIn-stijl feed voor market updates, certificaten en RFQ’s.
        </p>

        <div class="community-layout">
          <aside class="community-sidebar">
            <h3>Groups</h3>
            <ul id="group-list" class="group-list"></ul>
          </aside>

          <div class="community-main">
            <div class="community-header">
              <h3>Community feed: <span id="current-group-name">Market updates</span></h3>
            </div>

            <div id="post-feed" class="post-feed"></div>

            <form id="post-form" class="post-form">
              <textarea
                id="post-text"
                rows="3"
                placeholder="Deel een update, vertraging of certificaat..."
              ></textarea>
              <div class="post-form-row">
                <input type="file" id="post-file" />
                <button type="submit" class="primary-btn">Plaatsen</button>
              </div>
            </form>
          </div>
        </div>
      </section>

      <!-- ===== CHECKOUT ===== -->
      <section id="checkout" class="page">
        <h2>Checkout</h2>
        <p class="page-intro">
          Bereken totale kosten inclusief verzendkosten op basis van gewicht en
          regio.
        </p>

        <div class="checkout-layout">
          <div class="card">
            <h3>Verzendkosten</h3>
            <form id="shipping-form" class="shipping-form">
              <label>
                Regio
                <select id="ship-region">
                  <option value="NL">Nederland</option>
                  <option value="EU">Europa (EU)</option>
                  <option value="WORLD">Rest van de wereld</option>
                </select>
              </label>
              <label>
                Gewicht (kg)
                <input
                  type="number"
                  id="ship-weight"
                  step="0.1"
                  min="0"
                  placeholder="Wordt automatisch ingevuld na shoppen"
                />
              </label>
              <button type="submit" class="primary-btn">
                Bereken totaal
              </button>
            </form>
          </div>

          <div class="card summary-card">
            <h3>Samenvatting</h3>
            <p>Materiaal: €<span id="summary-material">0.00</span></p>
            <p>Verzending: €<span id="summary-shipping">0.00</span></p>
            <p>
              <strong>Totaal: €<span id="summary-total">0.00</span></strong>
            </p>
          </div>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      © <span id="year"></span> CompoLink – EU composite supply network
    </footer>
  </div>

  <!-- ============ SCRIPTS ============ -->

  <!-- Firebase v8 CDN -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

  <!-- JOUW FIREBASE CONFIG (INGEVULD) -->
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyA2BScDGFFpNaLTn7d5wpbDjLjAWe6eVXY",
      authDomain: "compolink-112.firebaseapp.com",
      projectId: "compolink-112",
      storageBucket: "compolink-112.firebasestorage.app",
      messagingSenderId: "1045338539276",
      appId: "1:1045338539276:web:7dbc0b80b0889dd3dd7529",
      measurementId: "G-VF4TTS8CJD"
    };
    firebase.initializeApp(firebaseConfig);
  </script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- JOUW SCRIPT.JS (de lange code die jij stuurde) -->
  <script src="script.js"></script>

  <!-- Live koersen voor #market-prices (met fallback) -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const list = document.getElementById("market-prices");
      if (!list) return;

      const fallback = [
        { symbol: "GOLD", price: 2350 },
        { symbol: "SILVER", price: 29.3 },
        { symbol: "PLATINUM", price: 980 },
        { symbol: "PALLADIUM", price: 1040 }
      ];

      async function loadPrices() {
        list.innerHTML = "<li>Koersen laden...</li>";
        try {
          const res = await fetch("https://api.metals.live/v1/spot");
          if (!res.ok) throw new Error("HTTP " + res.status);
          const data = await res.json();

          const symbols = ["gold", "silver", "platinum", "palladium"];
          const items = [];

          data.forEach(([symbol, price]) => {
            if (symbols.includes(String(symbol).toLowerCase())) {
              items.push({
                symbol: String(symbol).toUpperCase(),
                price: Number(price)
              });
            }
          });

          if (!items.length) throw new Error("Geen geldige data");

          list.innerHTML = "";
          items.forEach(({ symbol, price }) => {
            const li = document.createElement("li");
            li.className = "market-price-item";
            li.innerHTML = `
              <span class="material-symbol">${symbol}</span>
              <span class="material-price">${price.toFixed(2)} USD</span>
            `;
            list.appendChild(li);
          });
        } catch (err) {
          console.error("Fout bij laden koersen, gebruik fallback:", err);
          list.innerHTML = "";
          fallback.forEach(({ symbol, price }) => {
            const li = document.createElement("li");
            li.className = "market-price-item";
            li.innerHTML = `
              <span class="material-symbol">${symbol}</span>
              <span class="material-price">~ ${price.toFixed(2)} USD</span>
            `;
            list.appendChild(li);
          });
        }
      }

      loadPrices();
      setInterval(loadPrices, 600000); // elke 10 minuten
    });
  </script>
</body>
</html>
